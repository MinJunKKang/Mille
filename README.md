Discord Bot README (내전/전적/배팅/경제/관리/기타)

접두사: !
런타임: Python + discord.py
데이터: user_stats.json, mang.json, bad_words.json, stats.json(포인트)
주요 역할: 내전 (ID: 1409174707315544065)

개요

내전: 로비 → 팀장 선택 → 드래프트 → 팀 확정 → 결과 기록 / 한판더 / 팀다시뽑기

배팅: 내전 매치에 대해 3분 30초 내 [1팀/2팀] 배팅, 결과 시 자동 정산

미니게임: !도박1/2/3 (버튼 마인류, 크래시, 가위바위보)

경제 시스템: 출석, 지갑, 지급/회수, 송금, 보이스 랜덤 지급(수동+30분 스케줄)

전적/랭킹/스크림: JSON 기반 조회

관리/운영: 청소, 금칙어 추가/삭제, 메시지 필터

공통 정책/타이머

배팅 버튼 마감: 3분 30초(210초)

결과 타임아웃: 팀 확정 후 3시간(10800초) 내 미입력 시 버튼 비활성 + “시간 초과” 표기

권한

!청소: 사서/수석사서/큐레이터/관장/내전 역할 중 하나 보유 또는 서버 관리자

!스팸추가/!스팸삭제: 관리자 전용

!지급/!회수: 설정된 grant 역할 보유자 또는 관리자

!보이스랜덤/!보이스랜덤-온/오프: 관리자 전용, !보이스랜덤-금액: 큐레이터 전용

닉네임 포맷(LoL 링크): 소환사명#태그/티어/라인 (예: 김밀레#KR1/M575/TOP, JG)

FOW/OPGG 링크 생성 시 첫 ‘/’ 전까지(소환사명#태그)만 사용

🕹 게임/내전
!내전

흐름: 로비 생성 → [참여/취소/종료] → (인원 충족 시) 시작 → 팀장 선택(2명) → 드래프트(스네이크, 되돌리기 지원) → 팀 확정

멘션: 생성 시 역할 내전 멘션(1409174707315544065)

팀 확정 후 결과 미입력 3시간 경과 시 자동 타임아웃 표기

OPGG 멀티서치 버튼: 팀1/팀2 전적 보기 버튼 제공

배팅 UI: 팀 확정 직후 [1팀에 배팅] [2팀에 배팅] 버튼(Modal로 금액 입력, 최소 1000P, 중복 배팅 불가)

결과 기록/후속 액션

결과 버튼: [1팀 승리] / [2팀 승리] / [취소]

정산: 파리뮤추얼 방식 — 총 배팅금 / 승리팀 배팅금 배율로 당첨자 지급, 낙첨자는 소멸

취소: 모든 배팅 전액 환불

후속 버튼: [한판 더!] (동일 팀으로 새 매치) / [팀다시뽑기!] (같은 참가자 새 로비) / [종료]

로그

팀 구성/결과: Match.match_log_channel_id 채널로 임베드 전송

참여/취소 로그: Match.match_join_leave_log_channel_id 채널에 텍스트 로그

!전적 [@유저]

출처: user_stats.json

표시: 참여 / 승 / 패 / 승률 (멘션 없으면 본인)

!내전랭킹

대상: 참여 20회 이상

정렬: 승률 상위 Top20 (임베드 제목은 “Top10” 표기이지만 실제로 20명까지 출력)

!스크림 (또는 !스크림전적)

출처: mang.json

표시: 본인 스크림(멸망전) 전적(참여/승/패/승률)

💰 경제(포인트)
!출석

설정 시 전용 채널에서만 허용(Economy.attend_channel_id)

KST 기준 1일 1회, 보상 1,500P, 지급-로그 기록

!지갑 [@유저]

포인트/경험치 임베드 표시(없으면 0)

!지급 @대상 금액 / !회수 @대상 금액

권한자 전용(설정된 grant 역할 또는 관리자)

실행 결과 및 대상 잔액을 지급-로그 채널에 기록

!송금 @대상 금액 (별칭: !이체, !보내기)

본인 → 타인 포인트 이체(봇/자기 자신 불가, 잔액 검증)

양측 잔액 임베드 + 로그

보이스 랜덤(음성 추첨)

수동: !보이스랜덤 [금액=1000] (관리자) — AFK/봇 제외, 음성/스테이지 채널 참여자 중 랜덤 1명에게 지급

스케줄: 30분마다 자동 지급 (기본 ON)

!보이스랜덤-온 / !보이스랜덤-오프 (관리자)

!보이스랜덤-금액 <정수> (큐레이터 전용)

결과는 Economy.voice_announce_channel_id 채널로 공지(없으면 봇이 보낼 수 있는 첫 텍스트 채널)

🎛️ 배팅/미니게임

모든 금액 단위: P(포인트) / 최소 베팅 1000P

내전 배팅(매치 내 UI)

팀 확정 후 3분 30초 동안 배팅 가능(1회 한정, Modal 금액 입력)

결과 기록 시 자동 정산, 취소 시 전액 환불

!도박1 <베팅> — 버튼 마인류

4×4(16칸): 폭탄 6 + 배율칸 10

배율칸 고정 목록 무작위 배치: [0.5, 0.5, 0.6, 0.6, 0.7, 0.8, 0.9, 1.0, 1.5, 2.0]

합연산 누적: 수령액 = floor(베팅 × (열어온 배율의 합))

폭탄 시 전칸 공개, 2분 타임아웃 시 패배 처리

쿨다운: 유저당 7초

!도박2 <베팅> — 크래시(Crash)

배율은 0.50에서 시작해 틱당 ×1.045 상승(0.25초 간격), 최대 30x

크래시 지점 분포(버킷 확률; 예: 1.10~1.30=38%, 1.31~1.50=25% … 16~30=0.5%)

지금 받기 버튼으로 크래시 전에 수령, 실패 시 전액 소멸

쿨다운: 유저당 10초

썸네일: assets/graph.png

!도박3 <베팅> — 가위바위보

승리 배당 1.10x ~ 2.00x 랜덤, 비김 환불, 패배 소멸

선택 제한 15초, 쿨다운: 유저당 5초

🔎 LoL 전적 링크 (FOW/OPGG)

닉네임에서 첫 ‘/’ 전까지(소환사명#태그)를 추출해 전적 링크 구성

!내정보 [@유저] — 대상의 FOW 링크 버튼 임베드

!정보 @유저 — 멘션한 사용자의 링크 버튼 제공(멘션 없으면 사용법 안내)

내전 팀 확정 시 OPGG 멀티서치 버튼(팀1/팀2) 자동 제공

🧼 관리/운영
욕설/스팸

금칙어 파일: bad_words.json

{ "bad_words": ["바보", "금칙어예시"] }


일반 메시지(명령 !로 시작하는 메시지는 제외)에 금칙어가 포함되면:
→ “말 예쁘게~” 경고(특정 역할명에 따라 호칭 변경 지원)

명령어

!청소 <1~500>: 최근 N개 메시지 삭제 — 확인 버튼 UI로 재확인 후 실행

!스팸추가 <단어> / !스팸삭제 <단어>: 금칙어 추가/삭제(관리자 전용)

🎲 기타
!주사위

분포: 1~6 각 16%, 꽝 2%, 999 2%

assets의 해당 이미지가 있을 경우 임베드 이미지 표시

!고민 <아무 말>

“돌멩이” 랜덤 명언(최근 5개 중복 회피)

인자 필수: 내용 없이 입력 시 사용법 오류
